version: 2
jobs:
  ui-tests:
    machine:
      image: ubuntu-1604:202007-01

    steps:
      - checkout

      - run:
          name: Docker compose up
          command: |
            set -x
            docker-compose up
      - run:
          name: Running tests
          command: mvn clean test
      - run:
          name: Generate allure report
          command: mvn allure:report
          when: always
      - store_test_results:
          path: target/surefire-reports/junitreports
      - store_artifacts:
          path: target/site/allure-maven-plugin/
workflows:
  version: 2
  commit:
    jobs:
      - ui-tests
